
\subsubsection{READ}
\label{sec:rest:api:school:users:read}
Es sind nur Anfragen mit der HTTP-GET-Methode für ein READ auf die Daten zugelassen.
Bei diesem Aufruf wird eine Liste mit von Objekten übermittelt, auf welche der aktuelle Benutzer Zugriff hat.
Ein Objekt aus der Liste enthält immer für genau einen Benutzer die Information der Benutzer-ID, der Schul-ID, der Rollen-ID, eines Zeitpunkts, ab wann das Objekt gültig war, und optional eines Zeitpunkts, bis wann das Objekt gültig ist.
Gibt es Unterbrechungen in den Zeiträumen, in denen ein Benutzer eine Rolle in einer Schule eingenommen hat, so muss es für jeden Zeitraum ein eigenes Objekt geben.
Zum Abrufen von Daten mit IDs müssen die Anwendungen über die entsprechenden Spezialrouten gehen.
Die Antwort erfolgt mit dem JSON-Objekt \reflisting{lst:code:end:rest:api:school:users:read:ret}. 
Die einzelnen Felder der Antwort werden in \reftabllec{tab:end:rest:api:school:users:read:ret:json} beschrieben.
Die Berechtigungen auf den Endpunkt können \reftabllec{tab:end:rest:api:school:users:read:right} entnommen werden.

\input{json}
\begin{lstlisting}[caption={JSON-Antwort für einen GET-Aufruf der Route /api/school/users},label={lst:code:end:rest:api:school:users:read:ret},frame=tlrb]
[
 {
  school_id: "<STRING>",
  user_id: "<STRING>",
	role: "<STRING>",
	start: "<TIMESTAMP>",
	end: "<TIMESTAMP>",
	school-years: ["<STRING>",...,"<STRING>"]
 },
...
 {
  school_id: "<STRING>",
  user_id: "<STRING>",
	role: "<STRING>",
	start: "<TIMESTAMP>",
	end: "<TIMESTAMP>",
	school-years: ["<STRING>",...,"<STRING>"]
 },
]
\end{lstlisting}

\begin{table}[htb]
	\begin{tabularx}{\textwidth}{|c|c|X|}
		\hline
			\textbf{Feldname} & \textbf{Datentyp} & \textbf{Beschreibung} \\ \hline
			school\_id & STRING & ID der Schule \\ \hline
			user\_id & STRING & ID des Benutzers \\ \hline
			role & STRING & Rolle des Benutzers an der Schule \\ \hline
			start & TIMESTAMP & Zeitpunkt, ab wann der Benutzer diese Rolle innehat \\ \hline
			end & TIMESTAMP & Optional; gibt an, bis wann ein Benutzer diese Rolle innehatte \\ \hline
			school-years & LIST of STRINGS & Optional; das Feld gibt es nur, wenn die Rolle \textit{students} oder \textit{external-students} ist; enthält eine Liste von Schuljahres-IDs \\ \hline 
	\end{tabularx}

		\caption{Beschreibung der Felder in einem JSON-Objekt für einen Benutzer an einer Schule}
		\label{tab:end:rest:api:school:users:read:ret:json}
\end{table}

\begin{longtable}{|c|p{0.7\textwidth}|}
\caption{Berechtigungen auf dem Endpunkt}
\endfoot
\caption{Berechtigungen auf dem Endpunkt}
\label{tab:end:rest:api:school:users:read:right} 
\endlastfoot
\hline
\textbf{Benutzergruppen} & \textbf{Zugelassene Daten} \\ \hline
\endhead
guest & Darf den Endpunkt nicht aufrufen und keine Daten vom Endpunkt erhalten. \\ \hline
user & Bekommt eine Liste mit ihren Daten. \\ \hline 
students & Bekommt die Daten aller ihrer Mitschüler, mit denen sie gemeinsame Klassen oder Kurse habt (nur Rollen: \textit{students} und \textit{external-students}),
           den Daten ihrer Erziehungsberechtigten (nur Rolle \textit{guardians}), 
					 den Daten ihrer Lehrer (nur Rolle \textit{teacher}) und 
					 den Daten ihres Schulleiters (nur Rolle \textit{principal}) wieder.\\ \hline
external-students &  Bekommt eine Liste mit den Daten aller ihrer Mitschüler, mit denen sie gemeinsame Klassen oder Kurse hat (nur Rollen: \textit{students} und \textit{external-students}),
           den Daten ihrer Lehrer (nur Rolle \textit{teacher}) und 
					 den Daten ihres Schulleiters (nur Rolle \textit{principal}) wieder.\\ \hline
guardians & Bekommt eine Liste mit den Daten ihrer Kinder unter 18 (nur für die Rollen \textit{students} und \textit{external-students}), 
					den Daten der Personen, für die sie Vormund ist (nur für die Rollen \textit{students} und \textit{external-students}), 
					den Daten der Lehrer ihrer Kinder unter 18 (nur Rolle \textit{teacher}),
					den Daten der Lehrer von Personen, für die sie Vormund ist (nur Rolle \textit{teacher})	und
					den Daten der Schulleiter ihrer Kinder unter 18 oder Personen, für die sie die Vormundschaft hat (nur Rolle \textit{principal})
					wieder.\\ \hline
teacher & Bekommt eine Liste mit den Daten aller Schüler, die sie unterrichtet (nur für die Rollen \textit{students} und \textit{external-students}),
					den Daten aller Erziehungsberechtigten von Schülern unter 18, die sie unterrichtet (nur Rolle \textit{guardians}),
					den Daten aller Erziehungsberechtigten von Schülern mit einem Vormund, die sie unterrichtet (nur Rolle \textit{guardians}) und
					den Daten aller Kollegen (nur mit den Rollen \textit{teacher}, \textit{principal}, \textit{school-admin}) 
					wieder.\\ \hline
principal & Bekommt eine Liste mit ihren Daten,
            den Daten aller Schüler von Schulen, an denen sie Schulleiter ist (nur für die Rollen \textit{students} und \textit{external-students}),
						den Daten aller Erziehungsberechtigten von Schülern von Schulen, an denen Sie Schulleiter ist (nur Rolle \textit{guardians}) und
					  den Daten aller Kollegen (nur mit den Rollen \textit{teacher}, \textit{principal}, \textit{school-admin})
						wieder.\\ \hline
school-admin & Bekommt eine Liste mit ihren Daten und
               den Daten aller Personen von den Schulen, an denen sie die Rolle \textit{school-admin} hat, mit den Rollen \textit{students}, \textit{external-students}, \textit{guardians}, \textit{teacher}, \textit{principal} und \textit{school-admin} wieder.  \\ \hline
school-board & \textcolor[rgb]{1,0.41,0.13}{\textbf{Muss geklärt werden, welche Einschränkungen auf den Daten es hier gibt}} \\ \hline
fed-school-board & \textcolor[rgb]{1,0.41,0.13}{\textbf{Muss geklärt werden, welche Einschränkungen auf den Daten es hier gibt}} \\ \hline
sync-systems & Liste mit allen Personen, in den Rollen der Personen an den Schulen, von den es syncen darf. \\ \hline
	\end{longtable}
